# version: '3.8'

# services:
#   # Redis for caching and Celery broker
#   redis:
#     image: redis:7-alpine
#     container_name: bluesea_redis
#     ports:
#       - "6379:6379"
#     healthcheck:
#       test: ["CMD", "redis-cli", "ping"]
#       interval: 10s
#       timeout: 5s
#       retries: 5
#     restart: unless-stopped

#   # Django ASGI Application (Daphne - handles both HTTP and WebSocket)
#   web:
#     build: .
#     container_name: bluesea_web
#     volumes:
#       - .:/app
#       - static_volume:/app/staticfiles
#       - media_volume:/app/media
#     ports:
#       - "8000:8000"
#     env_file:
#       - .env
#     environment:
#       - CELERY_BROKER_URL=redis://redis:6379/0
#       - REDIS_URL=redis://redis:6379/1
#     depends_on:
#       redis:
#         condition: service_healthy
#     restart: unless-stopped
#     command: daphne -b 0.0.0.0 -p 8000 bluesea_mobile.asgi:application

#   # Celery Worker
#   celery_worker:
#     build: .
#     container_name: bluesea_celery_worker
#     command: celery -A bluesea_mobile worker --loglevel=info
#     volumes:
#       - .:/app
#     env_file:
#       - .env
#     environment:
#       - CELERY_BROKER_URL=redis://redis:6379/0
#       - REDIS_URL=redis://redis:6379/1
#     depends_on:
#       redis:
#         condition: service_healthy
#     restart: unless-stopped

#   # Celery Beat (for scheduled tasks)
#   celery_beat:
#     build: .
#     container_name: bluesea_celery_beat
#     command: celery -A bluesea_mobile beat --loglevel=info --scheduler django_celery_beat.schedulers:DatabaseScheduler
#     volumes:
#       - .:/app
#     env_file:
#       - .env
#     environment:
#       - CELERY_BROKER_URL=redis://redis:6379/0
#       - REDIS_URL=redis://redis:6379/1
#     depends_on:
#       redis:
#         condition: service_healthy
#       web:
#         condition: service_started
#     restart: unless-stopped

# volumes:
#   static_volume:
#   media_volume: